<!DOCTYPE html>
<html>

<head>
    <title>Jogo da Cobrinha</title>
</head>

<body>
    <center>
        <canvas id="stage" width="600" height="600"></canvas>
        <script type="text/javascript">

            window.onload = function () {

                var stage = document.getElementById('stage');
                var ctx = stage.getContext("2d");
                document.addEventListener("keydown", keyPush);
                setInterval(jogo, 100);

                const velocidade = 1;
                var velocidadeX = 0;
                var velocidadeY = 0;
                var pontoX = 10;
                var pontoY = 15;
                var tamanhoPonto = 30;
                var quantidadePonto = 20;
                var posicaoMacaX = 15;
                var posicaoMacaY = 15;

                var rastro = [];
                tamanhoCobra = 1;

                function jogo() {
                    pontoX += velocidadeX;
                    pontoY += velocidadeY;
                    if (pontoX < 0) {
                        pontoX = quantidadePonto - 1;
                    }
                    if (pontoX > quantidadePonto - 1) {
                        pontoX = 0;
                    }
                    if (pontoY < 0) {
                        pontoY = quantidadePonto - 1;
                    }
                    if (pontoY > quantidadePonto - 1) {
                        pontoY = 0;
                    }

                    ctx.fillStyle = "green";
                    ctx.fillRect(0, 0, stage.width, stage.height);

                    ctx.fillStyle = "red";
                    ctx.fillRect(posicaoMacaX * tamanhoPonto, posicaoMacaY * tamanhoPonto, tamanhoPonto, tamanhoPonto);

                    ctx.fillStyle = "black";
                    for (var i = 0; i < rastro.length; i++) {
                        ctx.fillRect(rastro[i].x * tamanhoPonto, rastro[i].y * tamanhoPonto, tamanhoPonto - 1, tamanhoPonto - 1);
                        if (rastro[i].x == pontoX && rastro[i].y == pontoY) {
                            velocidadeX = velocidadeY = 0;
                            tamanhoCobra = 1;
                        }
                    }

                    rastro.push({ x: pontoX, y: pontoY })
                    while (rastro.length > tamanhoCobra) {
                        rastro.shift();
                    }

                    if (posicaoMacaX == pontoX && posicaoMacaY == pontoY) {
                        tamanhoCobra++;
                        posicaoMacaX = Math.floor(Math.random() * quantidadePonto);
                        posicaoMacaY = Math.floor(Math.random() * quantidadePonto);
                    }

                }

                function keyPush(event) {

                    switch (event.keyCode) {
                        case 37:
                            velocidadeX = -velocidade;
                            velocidadeY = 0;
                            break;
                        case 38:
                            velocidadeX = 0;
                            velocidadeY = -velocidade;
                            break;
                        case 39:
                            velocidadeX = velocidade;
                            velocidadeY = 0;
                            break;
                        case 40:
                            velocidadeX = 0;
                            velocidadeY = velocidade;
                            break;
                        default:
                            break;
                    }
                }
            }
        </script>

    </center>
</body>

</html>